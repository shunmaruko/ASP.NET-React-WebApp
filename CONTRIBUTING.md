
<details closed="closed">
  <summary><h2 style="display: inline-block">Table of Contents</h2></summary>
  <ol>
    <li><a href="#1-installation">Installation</a></li>
    <li><a href="#2-backend">Backend</a></li>
    <li><a href="#3-frontend">Frontend</a></li>
  </ol>
</details>

## 1. Installation.
## 2. Backend.
### API Development
### Infrastructure Development
####  DB Migration
Since we use code first apporach, database can be migrated from Models on a Context baiss by the following steps.
  1. Install dotnet-ef.<br>
    `dotnet tool install --global dotnet-ef` 
  1. Change directory to Backend Project.<br>
      `cd $(ProjectDir)` 
  1. Check [Model](https://github.com/shunmaruko/ASP.NET-React-WebApp/tree/master/Backend/Models) and specify [Context](https://github.com/shunmaruko/ASP.NET-React-WebApp/tree/master/Backend/Infrastructure/Context).Then edit some model.
  1. Generate migration file from CLI.Yon can name XXX freely and need to designate some context specified by the above step.<br>
      `dotnet ef migrations add XXX -o Infrastructure/Migrations --context SomeContext`
  1. Execute migration.<br>
      `dotnet ef database update --context SomeContext`
  1. Finally you can check how it changed in SSOX.<br>
#### DB rollback 
When you want to cancel migration, you can do it by the following procedure.
  1. Revert migration to previsous migration (XXX).<br>
    `dotnet ef database update XXX --context SomeContext` <br>
     Or, if you go back before first migration, you can run:<br>
    `dotnet ef database update 0 --context SomeContext` <br>
  1. Remove last migration files. <br>
    `ef database migrations remove --context SomeContext`<br>
For more inforamation, you can see [here](https://learn.microsoft.com/ja-jp/ef/core/managing-schemas/migrations/applying?tabs=dotnet-core-cli).

### Authorization & Authentication Setup
#### Application Profile.
When you add client app, you first need to setup application profile. The setting is case by case as follows.
- For production
1. Host client app with IdentityServer <br>
  IdentityServrSPA profile is available.
1. If you have client app on different address <br>
  SPA profile should be used. You need to  designate at least, RedirectUrl and LogoutUrl.

- For development 
  In mememory certification are generated by default, see [source code](https://github.com/shunmaruko/ASP.NET-React-WebApp/blob/master/Backend/appsettings.Development.json).

Referece: <br>
- [Microsoft docs](https://learn.microsoft.com/ja-jp/aspnet/core/security/authentication/identity-api-authorization?view=aspnetcore-7.0#application-profiles)
- [Identity Server 4](https://identityserver4-ja.readthedocs.io/ja/latest/quickstarts/6_aspnet_identity.html)s
- To shortly know the differece between IdentityServerSPA and SPA, see [IdentityServer configuration to use it with SPA that is not hosted with IdentityServer](https://karolmemo.com/2020/06/23/identityserver-configuration-to-use-it-with-spa-that-is-not-hosted-with-identityserver/)
- For the difference of production and development certification see [this issue](https://github.com/jasontaylordev/CleanArchitecture/issues/149)

## 3. Frontend.
This project has no reusable components. UI component is delegeted to [Chakra UI](https://chakra-ui.com/).

The only rule is developer should use default Chakra UI componet as much as possible for the uniformity of design and reduce the cost of maintainance. Color themes are only available from [here](https://github.com/shunmaruko/ASP.NET-React-WebApp/blob/master/Frontend/src/components/ColorTheme.tsx).
### Authorization & Authentication Client

We use silent authentication approach with [oidc-client-ts](https://github.com/authts/oidc-client-ts). 
Its schematic is available from [here](https://github.com/authts/oidc-client-ts/blob/main/docs/protocols/silent-refresh-token-in-iframe-flow.md)


## 4. Others
- When committing, be sure to follow [best practices](https://github.com/erlang/otp/wiki/Writing-good-commit-messages) writing good commit descriptions.
